"use strict";(self.webpackChunkof_vue=self.webpackChunkof_vue||[]).push([[23619],{515015:function(t,e,n){n.d(e,{U:function(){return N},y:function(){return q}});var r=n(690853),s=n(65836),a;function o(t,e){for(let n=t.classList.length;n--;){const r=t.classList[n];if(e.test(r))return!0}return!1}function i(t,e,n=1/0,r=0){return t?t.nodeType!==t.ELEMENT_NODE||r>n?-1:e(t)?r:i(t.parentNode,e,n,r+1):-1}function c(t,e){return n=>{const r=n;if(null===r)return!1;try{if(t)if("string"==typeof t){if(r.matches(`.${t}`))return!0}else if(o(r,t))return!0;return!(!e||!r.matches(e))}catch(s){return!1}}}!function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"}(a||(a={}));const u="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.";let f={map:{},getId(){return console.error(u),-1},getNode(){return console.error(u),null},removeNodeFromMap(){console.error(u)},has(){return console.error(u),!1},reset(){console.error(u)}},p;function h(t,e,n,r,s=window){const a=s.Object.getOwnPropertyDescriptor(t,e);return s.Object.defineProperty(t,e,r?n:{set(t){setTimeout((()=>{n.set.call(this,t)}),0),a&&a.set&&a.set.call(this,t)}}),()=>h(t,e,a||{},!0)}function l(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],s=n(r);return"function"==typeof s&&(s.prototype=s.prototype||{},Object.defineProperties(s,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=s,()=>{t[e]=r}}catch(r){return()=>{}}}function d(t,e,n,r,s){if(!t)return!1;const a=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(!a)return!1;const o=c(e,n);if(!s){const t=r&&a.matches(r);return o(a)&&!t}const u=i(a,o);let f=-1;return!(u<0)&&(r&&(f=i(a,c(null,r))),u>-1&&f<0||u<f)}function g(){if(p)return p;const t=window.document;let e=window.requestAnimationFrame;if(t&&"function"==typeof t.createElement)try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const r=n.contentWindow;r&&r.requestAnimationFrame&&(e=r.requestAnimationFrame),t.head.removeChild(n)}catch(n){}return p=e.bind(window)}function m(...t){return g()(...t)}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(f=new Proxy(f,{get(t,e,n){return"map"===e&&console.error(u),Reflect.get(t,e,n)}})),/[1-9][0-9]{12}/.test(Date.now().toString());var y=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(y||{});let b;function v(t){b=t}const w=t=>{if(!b)return t;const e=undefined;return(...e)=>{try{return t(...e)}catch(n){if(b&&!0===b(n))return()=>{};throw n}}};for(var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",M="undefined"==typeof Uint8Array?[]:new Uint8Array(256),L=0;L<64;L++)M[C.charCodeAt(L)]=L;var O=function(t){var e=new Uint8Array(t),n,r=e.length,s="";for(n=0;n<r;n+=3)s+=C[e[n]>>2],s+=C[(3&e[n])<<4|e[n+1]>>4],s+=C[(15&e[n+1])<<2|e[n+2]>>6],s+=C[63&e[n+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s};const A=new Map;function _(t,e){let n=A.get(t);return n||(n=new Map,A.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}const x=(t,e,n)=>{if(!t||!D(t,e)&&"object"!=typeof t)return;const r=undefined,s=_(n,t.constructor.name);let a=s.indexOf(t);return-1===a&&(a=s.length,s.push(t)),a};function R(t,e,n){if(t instanceof Array)return t.map((t=>R(t,e,n)));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray){const e=undefined;return{rr_type:t.constructor.name,args:[Object.values(t)]}}if(t instanceof ArrayBuffer){const e=undefined,n=undefined;return{rr_type:t.constructor.name,base64:O(t)}}if(t instanceof DataView){const r=undefined;return{rr_type:t.constructor.name,args:[R(t.buffer,e,n),t.byteOffset,t.byteLength]}}if(t instanceof HTMLImageElement){const e=t.constructor.name,{src:n}=t;return{rr_type:e,src:n}}if(t instanceof HTMLCanvasElement){const e=undefined,n=undefined;return{rr_type:"HTMLImageElement",src:t.toDataURL()}}if(t instanceof ImageData){const r=undefined;return{rr_type:t.constructor.name,args:[R(t.data,e,n),t.width,t.height]}}if(D(t,e)||"object"==typeof t){const r=undefined,s=undefined;return{rr_type:t.constructor.name,index:x(t,e,n)}}return t}const S=(t,e,n)=>t.map((t=>R(t,e,n))),D=(t,e)=>{const n=undefined,r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((t=>"function"==typeof e[t]));return Boolean(r.find((n=>t instanceof e[n])))};function E(t,e,n,r,s){const a=[],o=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const c of o)try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[c])continue;const o=l(e.CanvasRenderingContext2D.prototype,c,(function(a){return function(...o){return d(this.canvas,n,r,s,!0)||setTimeout((()=>{const n=S(o,e,this);t(this.canvas,{type:y["2D"],property:c,args:n})}),0),a.apply(this,o)}}));a.push(o)}catch(i){const n=h(e.CanvasRenderingContext2D.prototype,c,{set(e){t(this.canvas,{type:y["2D"],property:c,args:[e],setter:!0})}});a.push(n)}return()=>{a.forEach((t=>t()))}}function k(t){return"experimental-webgl"===t?"webgl":t}function I(t,e,n,r,s){const a=[];try{const o=l(t.HTMLCanvasElement.prototype,"getContext",(function(t){return function(a,...o){if(!d(this,e,n,r,!0)){const t=k(a);if("__context"in this||(this.__context=t),s&&["webgl","webgl2"].includes(t))if(o[0]&&"object"==typeof o[0]){const t=o[0];t.preserveDrawingBuffer||(t.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return t.apply(this,[a,...o])}}));a.push(o)}catch(o){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{a.forEach((t=>t()))}}function T(t,e,n,r,s,a,o,i){const c=[],u=Object.getOwnPropertyNames(t);for(const p of u)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(p))try{if("function"!=typeof t[p])continue;const o=l(t,p,(function(t){return function(...o){const c=t.apply(this,o);if(x(c,i,this),"tagName"in this.canvas&&!d(this.canvas,r,s,a,!0)){const t=S(o,i,this),r={type:e,property:p,args:t};n(this.canvas,r)}return c}}));c.push(o)}catch(f){const r=h(t,p,{set(t){n(this.canvas,{type:e,property:p,args:[t],setter:!0})}});c.push(r)}return c}function U(t,e,n,r,s,a){const o=[];return o.push(...T(e.WebGLRenderingContext.prototype,y.WebGL,t,n,r,s,a,e)),void 0!==e.WebGL2RenderingContext&&o.push(...T(e.WebGL2RenderingContext.prototype,y.WebGL2,t,n,r,s,a,e)),()=>{o.forEach((t=>t()))}}var W='for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e="undefined"==typeof Uint8Array?[]:new Uint8Array(256),n=0;n<64;n++)e[t.charCodeAt(n)]=n;var a=function(e){var n,a=new Uint8Array(e),s=a.length,r="";for(n=0;n<s;n+=3)r+=t[a[n]>>2],r+=t[(3&a[n])<<4|a[n+1]>>4],r+=t[(15&a[n+1])<<2|a[n+2]>>6],r+=t[63&a[n+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r};const s=new Map,r=new Map;const i=self;i.onmessage=async function(t){if(!("OffscreenCanvas"in globalThis))return i.postMessage({id:t.data.id});{const{id:e,bitmap:n,width:o,height:f,dataURLOptions:c}=t.data,g=async function(t,e,n){const s=t+"-"+e;if("OffscreenCanvas"in globalThis){if(r.has(s))return r.get(s);const i=new OffscreenCanvas(t,e);i.getContext("2d");const o=await i.convertToBlob(n),f=await o.arrayBuffer(),c=a(f);return r.set(s,c),c}return""}(o,f,c),d=new OffscreenCanvas(o,f);d.getContext("2d").drawImage(n,0,0),n.close();const u=await d.convertToBlob(c),h=u.type,w=await u.arrayBuffer(),l=a(w);if(!s.has(e)&&await g===l)return s.set(e,l),i.postMessage({id:e});if(s.get(e)===l)return i.postMessage({id:e});i.postMessage({id:e,type:h,base64:l,width:o,height:f}),s.set(e,l)}};';function F(){const t=new Blob([W]);return URL.createObjectURL(t)}class B{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(t,e)=>{const n=undefined;!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)};const{sampling:e="all",win:n,blockClass:r,blockSelector:s,unblockSelector:a,recordCanvas:o,dataURLOptions:i,errorHandler:c}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,this.options=t,c&&v(c),t.enableManualSnapshot||w((()=>{o&&"all"===e&&this.initCanvasMutationObserver(n,r,s,a),o&&"number"==typeof e&&this.initCanvasFPSObserver(e,n,r,s,a,{dataURLOptions:i})}))()}initCanvasFPSObserver(t,e,n,r,s,a){const o=I(e,n,r,s,!0),i=this.takeSnapshot(!1,t,e,n,r,s,a.dataURLOptions);this.resetObservers=()=>{o(),cancelAnimationFrame(i)}}initCanvasMutationObserver(t,e,n,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const s=I(t,e,n,r,!1),a=E(this.processMutation.bind(this),t,e,n,r),o=U(this.processMutation.bind(this),t,e,n,r,this.mirror);this.resetObservers=()=>{s(),a(),o()}}snapshot(t){const{options:e}=this,n=this.takeSnapshot(!0,"all"===e.sampling?2:e.sampling||2,e.win,e.blockClass,e.blockSelector,e.unblockSelector,e.dataURLOptions,t);this.resetObservers=()=>{cancelAnimationFrame(n)}}takeSnapshot(t,e,n,s,a,o,i,c){const u=new Map,f=new Worker(F());f.onmessage=t=>{const e=t.data,{id:n}=e;if(u.set(n,!1),!("base64"in e))return;const{base64:r,type:s,width:a,height:o}=e;this.mutationCb({id:n,type:y["2D"],commands:[{property:"clearRect",args:[0,0,a,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:s}]},0,0]}]})};const p=1e3/e;let h=0,l;const g=t=>{if(t)return[t];const e=[];return n.document.querySelectorAll("canvas").forEach((t=>{d(t,s,a,o,!0)||e.push(t)})),e},b=e=>{h&&e-h<p||(h=e,g(c).forEach((e=>{const n=this.mirror.getId(e);if(!u.get(n)&&e.width&&e.height){if(u.set(n,!0),!t&&["webgl","webgl2"].includes(e.__context)){const t=e.getContext(e.__context);!1===(0,r.z)([t,"optionalAccess",t=>t.getContextAttributes,"call",t=>t(),"optionalAccess",t=>t.preserveDrawingBuffer])&&t.clear(t.COLOR_BUFFER_BIT)}createImageBitmap(e).then((t=>{f.postMessage({id:n,bitmap:t,width:e.width,height:e.height,dataURLOptions:i},[t])})).catch((t=>{w((()=>{throw t}))()}))}}))),l=m(b)};return l=m(b),l}startPendingCanvasMutationFlusher(){m((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,m(t)};m(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((t,e)=>{const n=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,n)})),m((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(t,e){if(this.frozen||this.locked)return;const n=this.pendingCanvasMutations.get(t);if(!n||-1===e)return;const r=n.map((t=>{const{type:e,...n}=t;return n})),{type:s}=n[0];this.mutationCb({id:e,type:s,commands:r}),this.pendingCanvasMutations.delete(t)}}const G={low:{sampling:{canvas:1},dataURLOptions:{type:"image/webp",quality:.25}},medium:{sampling:{canvas:2},dataURLOptions:{type:"image/webp",quality:.4}},high:{sampling:{canvas:4},dataURLOptions:{type:"image/webp",quality:.5}}},P="ReplayCanvas",j=(t={})=>{const e={quality:t.quality||"medium",enableManualSnapshot:t.enableManualSnapshot};let n;const r=new Promise((t=>n=t));return{name:P,setupOnce(){},getOptions(){const{quality:t,enableManualSnapshot:r}=e;return{enableManualSnapshot:r,recordCanvas:!0,getCanvasManager:t=>{const e=new B({...t,enableManualSnapshot:r,errorHandler:t=>{try{"object"==typeof t&&(t.__rrweb__=!0)}catch(e){}}});return n(e),e},...G[t||"medium"]||G.medium}},async snapshot(t){const e=undefined;(await r).snapshot(t)}}},q=(0,s._C)(j),N=(0,s.F)(P,q)}}]);